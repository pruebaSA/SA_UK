// (c) 2010 CodePlex Foundation
Type.registerNamespace("Sys.Extended.UI.Animation");Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior=function(b){var a=this;Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.initializeBase(a,[b]);a._onUpdating=new Sys.Extended.UI.Animation.GenericAnimationBehavior(b);a._onUpdated=new Sys.Extended.UI.Animation.GenericAnimationBehavior(b);a._postBackPending=null;a._pageLoadedHandler=null;a._AlwaysFinishOnUpdatingAnimation=null};Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.prototype={initialize:function(){var a=this;Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.callBaseMethod(a,"initialize");var c=a.get_element(),b=document.createElement(c.tagName);c.parentNode.insertBefore(b,c);b.appendChild(c);Array.remove(c._behaviors,a);Array.remove(c._behaviors,a._onUpdating);Array.remove(c._behaviors,a._onUpdated);if(b._behaviors){Array.add(b._behaviors,a);Array.add(b._behaviors,a._onUpdating);Array.add(b._behaviors,a._onUpdated)}else b._behaviors=[a,a._onUpdating,a._onUpdated];a._element=a._onUpdating._element=a._onUpdated._element=b;a._onUpdating.initialize();a._onUpdated.initialize();a.registerPartialUpdateEvents();a._pageLoadedHandler=Function.createDelegate(a,a._pageLoaded);a._pageRequestManager.add_pageLoaded(a._pageLoadedHandler)},dispose:function(){var a=this;if(a._pageRequestManager&&a._pageLoadedHandler){a._pageRequestManager.remove_pageLoaded(a._pageLoadedHandler);a._pageLoadedHandler=null}Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.callBaseMethod(a,"dispose")},_partialUpdateBeginRequest:function(c,b){var a=this;Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.callBaseMethod(a,"_partialUpdateBeginRequest",[c,b]);if(!a._postBackPending){a._postBackPending=true;a._onUpdated.quit();a._onUpdating.play()}},_pageLoaded:function(f,e){var a=this;if(a._postBackPending){a._postBackPending=false;for(var d=a.get_element(),c=e.get_panelsUpdated(),b=0;b<c.length;b++)if(c[b].parentNode==d){if(a._AlwaysFinishOnUpdatingAnimation)a._tryAndStopOnUpdating();else{a._onUpdating.quit();a._onUpdated.play()}break}}},_tryAndStopOnUpdating:function(){var a=this;if(a._onUpdating.get_animation().get_isPlaying()){var b=a;window.setTimeout(function(){b._tryAndStopOnUpdating.apply(b)},200)}else{a._onUpdating.quit();a._onUpdated.play()}},get_OnUpdating:function(){return this._onUpdating.get_json()},set_OnUpdating:function(a){this._onUpdating.set_json(a);this.raisePropertyChanged("OnUpdating")},get_OnUpdatingBehavior:function(){return this._onUpdating},get_OnUpdated:function(){return this._onUpdated.get_json()},set_OnUpdated:function(a){this._onUpdated.set_json(a);this.raisePropertyChanged("OnUpdated")},get_OnUpdatedBehavior:function(){return this._onUpdated},get_AlwaysFinishOnUpdatingAnimation:function(){return this._AlwaysFinishOnUpdatingAnimation},set_AlwaysFinishOnUpdatingAnimation:function(a){if(this._AlwaysFinishOnUpdatingAnimation!=a){this._AlwaysFinishOnUpdatingAnimation=a;this.raisePropertyChanged("AlwaysFinishOnUpdatingAnimation")}}};Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior.registerClass("Sys.Extended.UI.Animation.UpdatePanelAnimationBehavior",Sys.Extended.UI.BehaviorBase);